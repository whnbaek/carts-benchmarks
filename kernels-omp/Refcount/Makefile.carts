# CARTS Makefile for Refcount example

CFLAGS = -fopenmp -O0
INCLUDES = -I..

SRC = refcount.c

all: mlir arts

mlir: refcount.mlir

arts: refcount_arts.mlir

refcount.mlir: $(SRC)
	carts cgeist $(SRC) $(CFLAGS) $(INCLUDES) -S > refcount.mlir

refcount_arts.mlir: refcount.mlir
	carts run refcount.mlir --convert-openmp --debug-only=convert_openmp_to_arts > refcount_arts.mlir

clean:
	rm -f *.mlir *.o

.PHONY: all mlir arts clean
