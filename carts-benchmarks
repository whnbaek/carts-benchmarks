#!/usr/bin/env bash
################################################################################
# carts-benchmarks - CARTS Benchmark Runner
#
# This script delegates to the Python benchmark_runner.py for all functionality.
#
# Usage:
#   carts-benchmarks list [--suite SUITE] [--format FORMAT]
#   carts-benchmarks run [BENCHMARKS...] [OPTIONS]
#   carts-benchmarks build [BENCHMARKS...] [--size SIZE]
#   carts-benchmarks clean [BENCHMARKS...] [--all]
#   carts-benchmarks report [--format FORMAT] [--output FILE]
#
################################################################################

set -euo pipefail

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
PYTHON_RUNNER="${SCRIPT_DIR}/benchmark_runner.py"

# Check if Python runner exists
if [ ! -f "$PYTHON_RUNNER" ]; then
    echo "Error: benchmark_runner.py not found at $PYTHON_RUNNER" >&2
    exit 1
fi

# Delegate to Python runner
if command -v poetry &> /dev/null && [ -f "${SCRIPT_DIR}/pyproject.toml" ]; then
    cd "$SCRIPT_DIR"
    exec poetry run python benchmark_runner.py "$@"
else
    exec python3 "$PYTHON_RUNNER" "$@"
fi
