# CARTS Makefile for KASTORS Strassen

CFLAGS = -fopenmp -O0 -DMSIZE=1 -DCUTOFF_SIZE=1 -DCUTOFF_DEPTH=1
INCLUDES = -Iinclude -I.. -I../common

SRCS = \
  src/strassen.c \
  src/strassen-task.c \
  src/strassen-task-dep.c \
  src/strassen-seq.c \
  main_strassen.c

all: $(SRCS:.c=_arts.mlir)

%.mlir: %.c
	carts cgeist $< $(CFLAGS) $(INCLUDES) -S > $@

%_arts.mlir: %.mlir
	carts run $< --convert-openmp --debug-only=convert_openmp_to_arts > $@

clean:
	rm -f src/*.mlir *.mlir

.PHONY: all clean
